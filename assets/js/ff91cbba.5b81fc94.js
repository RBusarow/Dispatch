"use strict";(self.webpackChunkdispatch=self.webpackChunkdispatch||[]).push([[744],{5752:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=n(7462),r=(n(7294),n(3905));n(8209);const i={id:"dispatch-detekt",title:"Detekt",sidebar_label:"Detekt"},o=void 0,l={unversionedId:"modules/dispatch-detekt",id:"modules/dispatch-detekt",title:"Detekt",description:"Rules",source:"@site/docs/modules/dispatch-detekt.md",sourceDirName:"modules",slug:"/modules/dispatch-detekt",permalink:"/Dispatch/docs/next/modules/dispatch-detekt",draft:!1,editUrl:"https://github.com/rbusarow/Dispatch/edit/main/website/docs/modules/dispatch-detekt.md",tags:[],version:"current",frontMatter:{id:"dispatch-detekt",title:"Detekt",sidebar_label:"Detekt"},sidebar:"Docs",previous:{title:"Core",permalink:"/Dispatch/docs/next/modules/dispatch-core"},next:{title:"Espresso",permalink:"/Dispatch/docs/next/modules/dispatch-android-espresso"}},d={},s=[{value:"Rules",id:"rules",level:2},{value:"Setup",id:"setup",level:2},{value:"Adding new dependencies",id:"adding-new-dependencies",level:3},{value:"Configuration",id:"configuration",level:3},{value:"Gradle Daemon bug",id:"gradle-daemon-bug",level:3}],c={toc:s};function p(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"rules"},"Rules"),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"Name")),(0,r.kt)("th",{parentName:"tr",align:null},(0,r.kt)("strong",{parentName:"th"},"Description")))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-detekt/dispatch.detekt.rules/-android-x-lifecycle-scope/index.html"},"AndroidXLifecycleScope")),(0,r.kt)("td",{parentName:"tr",align:null},"Looks for accidental usage of the ",(0,r.kt)("a",{parentName:"td",href:"https://cs.android.com/androidx/platform/frameworks/support/+/androidx-master-dev:lifecycle/lifecycle-runtime-ktx/src/main/java/androidx/lifecycle/Lifecycle.kt;l=44"},"androidx lifecyclescope")," extension.")),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-detekt/dispatch.detekt.rules/-hard-coded-dispatcher/index.html"},"HardCodedDispatcher")),(0,r.kt)("td",{parentName:"tr",align:null},"Detects use of a hard-coded reference to the ",(0,r.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-dispatchers/index.html"},"kotlinx.coroutines.Dispatchers")," singleton.")))),(0,r.kt)("h2",{id:"setup"},"Setup"),(0,r.kt)("p",null,"If you don't already have ",(0,r.kt)("a",{parentName:"p",href:"https://detekt.github.io/detekt"},"Detekt")," set up in your project,\nfollow ",(0,r.kt)("a",{parentName:"p",href:"https://detekt.github.io/detekt/#quick-start-with-gradle"},"the official quick start guide"),"."),(0,r.kt)("p",null,"After that is working, you need to add dependencies for the Detekt CLI and these extension rules to\neach module which will be analyzed. The easiest way to do this is to apply them from the ",(0,r.kt)("strong",{parentName:"p"},"root\nproject"),"-level gradle file."),(0,r.kt)("h3",{id:"adding-new-dependencies"},"Adding new dependencies"),(0,r.kt)("p",null,"In root project-level ",(0,r.kt)("inlineCode",{parentName:"p"},"build.gradle")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"build.gradle.kts"),":"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-kotlin"},'allprojects {\n  dependencies {\n    detekt("io.gitlab.arturbosch.detekt:detekt-cli:1.14.2")\n\n    detektPlugins("com.rickbusarow.dispatch:dispatch-detekt:1.0.0-beta10-SNAPSHOT")\n  }\n}\n')),(0,r.kt)("h3",{id:"configuration"},"Configuration"),(0,r.kt)("p",null,"After adding the dependencies, you'll want to add parameters to your detekt config .yml file."),(0,r.kt)("p",null,"If you don't already have a config file, you can create one by invoking:"),(0,r.kt)("p",null,(0,r.kt)("inlineCode",{parentName:"p"},"./gradlew detektGenerateConfig")),(0,r.kt)("p",null,"Then, add the following to the bottom of the ",(0,r.kt)("inlineCode",{parentName:"p"},"detekt-config.yml")," file:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"dispatch:\n  active: true                             # disables all dispatch checks\n  AndroidXLifecycleScope:             # incorrect lifecycleScope\n    active: true\n  HardCodedDispatcher:                     # finds usage of Dispatchers.______\n    active: true\n    allowDefaultDispatcher: false          # if true, Detekt will ignore all usage of Dispatchers.Default\n    allowIODispatcher: false               # if true, Detekt will ignore all usage of Dispatchers.IO\n    allowMainDispatcher: false             # if true, Detekt will ignore all usage of Dispatchers.Main\n    allowMainImmediateDispatcher: false    # if true, Detekt will ignore all usage of Dispatchers.Main.immediate\n    allowUnconfinedDispatcher: false       # if true, Detekt will ignore all usage of Dispatchers.Unconfined\n")),(0,r.kt)("h3",{id:"gradle-daemon-bug"},"Gradle Daemon bug"),(0,r.kt)("p",null,"There is an ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/detekt/detekt/issues/2582"},"issue")," with ClassLoader caching which may\ncause issues the first time running Detekt. The workaround is to execute ",(0,r.kt)("inlineCode",{parentName:"p"},"./gradlew --stop")," once via\ncommand line. You should only ever need to do this one time, if at all. The fix for this has already\nbeen merged into Detekt."))}p.isMDXComponent=!0},3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var d=a.createContext({}),s=function(e){var t=a.useContext(d),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},c=function(e){var t=s(e.components);return a.createElement(d.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,d=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(n),h=r,f=u["".concat(d,".").concat(h)]||u[h]||p[h]||i;return n?a.createElement(f,o(o({ref:t},c),{},{components:n})):a.createElement(f,o({ref:t},c))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=u;var l={};for(var d in t)hasOwnProperty.call(t,d)&&(l[d]=t[d]);l.originalType=e,l.mdxType="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},8209:(e,t,n)=>{n(7294)}}]);