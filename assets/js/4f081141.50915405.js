"use strict";(self.webpackChunkdispatch=self.webpackChunkdispatch||[]).push([[754],{5606:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var r=i(7462),n=(i(7294),i(3905));i(8209);const o={id:"dispatch-android-espresso",title:"Espresso",sidebar_label:"Espresso"},a=void 0,s={unversionedId:"modules/dispatch-android-espresso",id:"version-1.0.0-beta10/modules/dispatch-android-espresso",title:"Espresso",description:"Tools to provide [Espresso] [IdlingResource] functionality for coroutines.",source:"@site/versioned_docs/version-1.0.0-beta10/modules/dispatch-android-espresso.md",sourceDirName:"modules",slug:"/modules/dispatch-android-espresso",permalink:"/Dispatch/docs/modules/dispatch-android-espresso",draft:!1,editUrl:"https://github.com/rbusarow/Dispatch/edit/main/website/versioned_docs/version-1.0.0-beta10/modules/dispatch-android-espresso.md",tags:[],version:"1.0.0-beta10",frontMatter:{id:"dispatch-android-espresso",title:"Espresso",sidebar_label:"Espresso"},sidebar:"version-1.0.0-beta10/Basics",previous:{title:"Detekt",permalink:"/Dispatch/docs/modules/dispatch-detekt"},next:{title:"Lifecycle",permalink:"/Dispatch/docs/modules/dispatch-android-lifecycle"}},d={},p=[{value:"Types",id:"types",level:2},{value:"IdlingCoroutineScopes",id:"idlingcoroutinescopes",level:2},{value:"Minimum Gradle Config",id:"minimum-gradle-config",level:2}],l={toc:p};function c(e){let{components:t,...i}=e;return(0,n.kt)("wrapper",(0,r.Z)({},l,i,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Tools to provide ",(0,n.kt)("a",{parentName:"p",href:"https://developer.android.com/training/testing/espresso/idling-resource"},"Espresso")," functionality for coroutines."),(0,n.kt)("p",null,"If an ",(0,n.kt)("a",{parentName:"p",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-dispatcher-provider/index.html"},"IdlingDispatcherProvider")," is registered with the ",(0,n.kt)("a",{parentName:"p",href:"https://developer.android.com/reference/androidx/test/espresso/IdlingRegistry"},"IdlingRegistry"),", ",(0,n.kt)("a",{parentName:"p",href:"https://developer.android.com/training/testing/espresso"},"Espresso")," will wait for\nall associated coroutines to leave the ",(0,n.kt)("em",{parentName:"p"},"active")," state before performing any assertions."),(0,n.kt)("p",null,"Coroutines which are in a ",(0,n.kt)("em",{parentName:"p"},"suspended")," state (such as a ",(0,n.kt)("a",{parentName:"p",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-job/index.html"},"Job"),' "observing" a ',(0,n.kt)("a",{parentName:"p",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines.flow/-flow/index.html"},"Flow")," for updates)\ndo not prevent Espresso from performing assertions."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-kotlin"},'class IdlingCoroutineScopeRuleWithLifecycleSample {\n\n  // Retrieve the DispatcherProvider from a dependency graph,\n  // so that the same one is used throughout the codebase.\n  val customDispatcherProvider = testAppComponent.customDispatcherProvider\n\n  @JvmField\n  @Rule\n  val idlingRule = IdlingDispatcherProviderRule {\n    IdlingDispatcherProvider(customDispatcherProvider)\n  }\n\n  /**\n  * If you don\'t provide CoroutineScopes to your lifecycle components via a dependency injection framework,\n  * you need to use the `dispatch-android-lifecycle-extensions` and `dispatch-android-viewmodel` artifacts\n  * to ensure that the same `IdlingDispatcherProvider` is used.\n  */\n  @Before\n  fun setUp() {\n    LifecycleScopeFactory.set {\n      MainImmediateCoroutineScope(customDispatcherProvider)\n    }\n    ViewModelScopeFactory.set {\n      MainImmediateCoroutineScope(customDispatcherProvider)\n    }\n  }\n\n  @Test\n  fun testThings() = runBlocking {\n\n    // Now any CoroutineScope which uses the DispatcherProvider\n    // in TestAppComponent will sync its "idle" state with Espresso\n\n  }\n\n}\n')),(0,n.kt)("h2",{id:"types"},"Types"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"Name")),(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"Description")))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-dispatcher-provider-rule/index.html"},"IdlingDispatcherProviderRule")),(0,n.kt)("td",{parentName:"tr",align:null},"JUnit 4 ",(0,n.kt)("a",{parentName:"td",href:"https://junit.org/junit4/javadoc/4.12/org/junit/Rule.html"},"Rule")," which automatically registers an ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-dispatcher-provider/index.html"},"IdlingDispatcherProvider")," with the ",(0,n.kt)("a",{parentName:"td",href:"https://developer.android.com/reference/androidx/test/espresso/IdlingRegistry"},"IdlingRegistry"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-dispatcher/index.html"},"IdlingDispatcher")),(0,n.kt)("td",{parentName:"tr",align:null},"A ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html"},"CoroutineDispatcher")," which tracks each dispatched coroutine using a ",(0,n.kt)("a",{parentName:"td",href:"https://developer.android.com/reference/androidx/test/espresso/idling/CountingIdlingResource"},"CountingIdlingResource"),". All actual dispatches are delegated to a provided ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html"},"CoroutineDispatcher"),".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-dispatcher-provider/index.html"},"IdlingDispatcherProvider")),(0,n.kt)("td",{parentName:"tr",align:null},"A special ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-core/dispatch.core/-dispatcher-provider/index.html"},"DispatcherProvider")," which guarantees that each of its properties is an ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-dispatcher/index.html"},"IdlingDispatcher"))),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-coroutine-scope/index.html"},"IdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},"A special ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/coroutine-scope.html"},"CoroutineScope")," which guarantees a property of an ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-dispatcher-provider/index.html"},"IdlingDispatcherProvider"))))),(0,n.kt)("h2",{id:"idlingcoroutinescopes"},"IdlingCoroutineScopes"),(0,n.kt)("table",null,(0,n.kt)("thead",{parentName:"table"},(0,n.kt)("tr",{parentName:"thead"},(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"Marker Interface")),(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"Factory Function")),(0,n.kt)("th",{parentName:"tr",align:null},(0,n.kt)("strong",{parentName:"th"},"Description")))),(0,n.kt)("tbody",{parentName:"table"},(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-default-idling-coroutine-scope/index.html"},"DefaultIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-default-idling-coroutine-scope/index.html"},"DefaultIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},"A ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-coroutine-scope/index.html"},"IdlingCoroutineScope")," with a ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html"},"CoroutineDispatcher")," of ",(0,n.kt)("inlineCode",{parentName:"td"},"default"),".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-i-o-idling-coroutine-scope/index.html"},"IOIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-i-o-idling-coroutine-scope/index.html"},"IOIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},"A ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-coroutine-scope/index.html"},"IdlingCoroutineScope")," with a ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html"},"CoroutineDispatcher")," of ",(0,n.kt)("inlineCode",{parentName:"td"},"io"),".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-main-idling-coroutine-scope/index.html"},"MainIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-main-idling-coroutine-scope/index.html"},"MainIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},"A ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-coroutine-scope/index.html"},"IdlingCoroutineScope")," with a ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html"},"CoroutineDispatcher")," of ",(0,n.kt)("inlineCode",{parentName:"td"},"main"),".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-main-immediate-idling-coroutine-scope/index.html"},"MainImmediateIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-main-immediate-idling-coroutine-scope/index.html"},"MainImmediateIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},"A ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-coroutine-scope/index.html"},"IdlingCoroutineScope")," with a ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html"},"CoroutineDispatcher")," of ",(0,n.kt)("inlineCode",{parentName:"td"},"mainImmediate"),".")),(0,n.kt)("tr",{parentName:"tbody"},(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-unconfined-idling-coroutine-scope/index.html"},"UnconfinedIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-unconfined-idling-coroutine-scope/index.html"},"UnconfinedIdlingCoroutineScope")),(0,n.kt)("td",{parentName:"tr",align:null},"A ",(0,n.kt)("a",{parentName:"td",href:"https://rbusarow.github.io/Dispatch/api/dispatch-android-espresso/dispatch.android.espresso/-idling-coroutine-scope/index.html"},"IdlingCoroutineScope")," with a ",(0,n.kt)("a",{parentName:"td",href:"https://kotlin.github.io/kotlinx.coroutines/kotlinx-coroutines-core/kotlinx.coroutines/-coroutine-dispatcher/index.html"},"CoroutineDispatcher")," of ",(0,n.kt)("inlineCode",{parentName:"td"},"unconfined"),".")))),(0,n.kt)("h2",{id:"minimum-gradle-config"},"Minimum Gradle Config"),(0,n.kt)("p",null,"Add to your module's ",(0,n.kt)("inlineCode",{parentName:"p"},"build.gradle.kts"),":"),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-kotlin"},'repositories {\n  mavenCentral()\n}\n\ndependencies {\n\n  // core\n  implementation("org.jetbrains.kotlinx:kotlinx-coroutines-core:1.5.2")\n  implementation("org.jetbrains.kotlinx:kotlinx-coroutines-android:1.5.2")\n  implementation("com.rickbusarow.dispatch:dispatch-core:1.0.0-beta10")\n\n  androidTestImplementation("com.rickbusarow.dispatch:dispatch-android-espresso:1.0.0-beta10")\n\n  // android\n  androidTestImplementation("androidx.test:runner:1.3.0")\n  androidTestImplementation("androidx.test.espresso:espresso-core:3.3.0")\n}\n')))}c.isMDXComponent=!0},3905:(e,t,i)=>{i.d(t,{Zo:()=>l,kt:()=>u});var r=i(7294);function n(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function o(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,r)}return i}function a(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?o(Object(i),!0).forEach((function(t){n(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function s(e,t){if(null==e)return{};var i,r,n=function(e,t){if(null==e)return{};var i,r,n={},o=Object.keys(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||(n[i]=e[i]);return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}var d=r.createContext({}),p=function(e){var t=r.useContext(d),i=t;return e&&(i="function"==typeof e?e(t):a(a({},t),e)),i},l=function(e){var t=p(e.components);return r.createElement(d.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var i=e.components,n=e.mdxType,o=e.originalType,d=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),h=p(i),u=n,m=h["".concat(d,".").concat(u)]||h[u]||c[u]||o;return i?r.createElement(m,a(a({ref:t},l),{},{components:i})):r.createElement(m,a({ref:t},l))}));function u(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=i.length,a=new Array(o);a[0]=h;var s={};for(var d in t)hasOwnProperty.call(t,d)&&(s[d]=t[d]);s.originalType=e,s.mdxType="string"==typeof e?e:n,a[1]=s;for(var p=2;p<o;p++)a[p]=i[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,i)}h.displayName="MDXCreateElement"},8209:(e,t,i)=>{i(7294)}}]);